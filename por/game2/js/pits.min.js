var listen=function(c,b,a){if(c){if(c.addEventListener){c.addEventListener(b,a)}else{if(c.bind){c.bind(b,a)}}}};var resizeWinTimeout=null;var resizeWin=function(){resizeWinTimeout&&clearTimeout(resizeWinTimeout);resizeWinTimeout=setTimeout(function(){var b=location.href;var a=b.indexOf("?");if(a>-1){b=b.substring(0,a)}location.href=b+"?d="+(new Date().getTime())},500)};var addClass=function(e,a){if(!e||!a||!a.length){return}var c=e.className;if(!c){e.className=a.join(" ")}else{var b=c.split(" ").filter(function(f){return !!f});var d=0;a.forEach(function(f){if(b.indexOf(f)==-1){b.push(f);++d}});d>0&&(e.className=b.join(" "))}};var removeClass=function(e,a){if(!e||!e.className||!a||!a.length){return}var d=e.className;var c=d.split(" ").filter(function(f){return !!f});var b=0;a.forEach(function(g){var f=c.indexOf(g);if(f!=-1){c.splice(f,1);++b}});b>0&&(e.className=c.join(" "))};var renderCenterRect=function(c,a,b){if(!c){return}c.style.width=a+"px";c.style.height=a+"px";c.style.left=(b-a)/2+"px"};var renderRect=function(b,a){if(!b){return}b.style.width=a+"px";b.style.height=a+"px"};var renderLeft=function(b,a){b&&(b.style.left=a+"px")};var renderRight=function(b,a){b&&(b.style.right=a+"px")};var renderTop=function(b,a){b&&(b.style.top=a+"px")};var renderHeight=function(b,a){b&&(b.style.height=a+"px")};var renderWidth=function(b,a){b&&(b.style.width=a+"px")};var isMobile=function(){var b=navigator.userAgent.toLowerCase(),e=b.match(/ipad/i)=="ipad",g=b.match(/iphone os/i)=="iphone os",d=b.match(/midp/i)=="midp",f=b.match(/rv:1.2.3.4/i)=="rv:1.2.3.4",i=b.match(/ucweb/i)=="ucweb",h=b.match(/android/i)=="android",c=b.match(/windows ce/i)=="windows ce",j=b.match(/windows mobile/i)=="windows mobile",a=b.match(/webview/i)=="webview";return(e||g||d||f||i||h||c||j)};var init=function(){var a=document.body.clientWidth;var P=document.body.clientHeight;var Z=a<P?a:P;var e=Z/5;var R=e*0.2;var b=e;(R>20)&&(R=20);var f=R/2;var ah=e*2;var ai=f;document.body.className=a>=P?"horizontal":"vertical";var z=document.querySelector("#main-container");var N=document.querySelector("#pit-one");var aq=document.querySelector("#pit-two");var aj=document.querySelector("#filling-one");var p=document.querySelector("#filling-two");var ag=document.querySelector("#player");var aa=document.querySelector("#award");var c=document.querySelector("#score");var af=document.querySelector("#score-container");var t=document.querySelector("#result-container");var ad=document.querySelector("#result-score");var S=document.querySelector("#result-msg");var U=document.querySelector("#logo");var g=document.querySelector("#nav-container");var I=N;var u=aj;var B=aq;var k=p;var ab=false;var am=false;var W=0;var Y;var C=200;var ak={THROUGH:0,TOO_WIDE:1,TOO_HIGH:2,BLOCK:3};var ap=["太远了，过不去","摔死啦","撞墙啦"];var w=5;var D=15;var o=10;var s=30;var n=5;var r=10;var ao="hide";var G="transparent";var M="smooth";var ar="emphasized";var V,j,A;if(isMobile()){V="touchstart";j="touchmove";A="touchend"}else{V="mousedown";j="mousemove";A="mouseup"}var l=function(){addClass(document.querySelector("#about-container"),["show"])};var ae=function(){removeClass(document.querySelector("#about-container"),["show"])};var F=function(){addClass(document.querySelector("#intro-container"),["show"])};var d=function(){removeClass(document.querySelector("#intro-container"),["show"])};var T=function(){i();addClass(U,[G]);addClass(g,[G]);setTimeout(function(){addClass(U,[ao]);addClass(g,[ao])},C)};var i=function(){ab=false;W=0;ai=f;Y&&clearInterval(Y);K();c.innerHTML=W;removeClass(af,[ao,G]);removeClass(u,[ao]);renderTop(u,20);renderCenterRect(u,ai,a);renderCenterRect(I,b,a);H();setTimeout(function(){removeClass(u,[M]);ab=true},C)};var an=function(){if(ab){ab=false;am=true;Y&&clearInterval(Y);Y=setInterval(function(){ai<ah&&(ai+=1);renderCenterRect(u,ai,a)},10)}};var J=function(av){if(am&&Y){av.preventDefault();av.returnValue=false;am=false;clearInterval(Y);Y=null;addClass(u,[M]);var at=P*0.5-ai;var au=m(ai,b);if(au){at+=b}renderTop(u,at);setTimeout(function(){removeClass(u,[M]);E(au)},C)}};var E=function(at){if(at){switch(al(ai,b)){case ak.THROUGH:renderLeft(ag,a*0.75-ag.clientWidth/2);setTimeout(function(){addClass(aa,[M]);renderRight(aa,20+c.clientWidth);renderTop(aa,20-P/2);setTimeout(function(){removeClass(aa,[M]);addClass(aa,[ao]);addClass(c,[ar]);c.innerHTML=++W;setTimeout(function(){removeClass(c,[ar])},C);v()},C)},C);break;case ak.TOO_WIDE:renderLeft(ag,(a-b)/2);setTimeout(function(){renderTop(ag,b-ag.clientHeight);setTimeout(function(){Q(ak.TOO_WIDE)},C)},C);break;case ak.TOO_HIGH:renderLeft(ag,(a-b)/2);setTimeout(function(){renderTop(ag,b-ai-ag.clientHeight);setTimeout(function(){Q(ak.TOO_HIGH)},C)},C);break}}else{renderLeft(ag,(a-ai)/2-ag.clientWidth);setTimeout(function(){Q(ak.BLOCK)},C)}};var v=function(){y();h();x();O();L()};var y=function(){removeClass(k,[M]);removeClass(B,[M]);removeClass(aa,[M,ao]);ai=f;b=q(R,e);H();renderRect(k,ai);renderRect(B,b);renderTop(k,20);renderLeft(k,a+ai);renderLeft(B,a+b);renderRight(aa,-(a/2));renderTop(aa,-aa.clientHeight)};var h=function(){renderLeft(I,-I.clientWidth);renderLeft(u,-u.clientWidth);renderLeft(ag,a*0.2)};var x=function(){addClass(k,[M]);addClass(B,[M]);addClass(aa,[M]);renderLeft(k,(a-ai)/2);renderLeft(B,(a-b)/2);renderRight(aa,a*0.2);setTimeout(function(){removeClass(u,[M]);removeClass(k,[M])},C)};var O=function(){var at=k;k=u;u=at;at=B;B=I;I=at};var L=function(){setTimeout(function(){ab=true},C*2)};var m=function(at,au){return at<=au};var al=function(at,aw){var av=aw-at;var au=av/2;if(au>n){return ak.TOO_WIDE}if(av>r){return ak.TOO_HIGH}return ak.THROUGH};var q=function(at,av){var au=parseInt(at+(av-at)*Math.random());return au>av?av:au<at?at:au};var Q=function(at){at=parseInt(at);var au="失败啦";if(at>=1&&at<=3){au=ap[at-1]}ad.innerHTML=W;S.innerHTML=au;addClass(t,[M]);removeClass(t,[ao,G])};var X=function(){addClass(t,[G]);setTimeout(function(){addClass(t,[ao])},C);i()};var ac=function(){addClass(u,[G]);addClass(t,[G]);addClass(af,[G]);setTimeout(function(){addClass(u,[ao]);addClass(t,[ao]);addClass(af,[ao]);removeClass(U,[ao,G]);removeClass(g,[ao,G]);renderHeight(I,P*0.1);renderWidth(I,a*0.2);renderLeft(I,a*0.4);K()},C)};var K=function(){renderLeft(ag,a*0.2);renderTop(ag,-ag.clientHeight)};var H=function(){n=b*0.2;if(n<w){n=w}else{if(n>D){n=D}}r=b*0.3;if(r<o){r=o}else{if(r>s){r=s}}};listen(document.querySelector("#nav-about"),"click",l);listen(document.querySelector("#close-about"),"click",ae);listen(document.querySelector("#nav-intro"),"click",F);listen(document.querySelector("#close-intro"),"click",d);listen(document.querySelector("#nav-start"),"click",T);listen(document.querySelector("#replay"),"click",X);listen(document.querySelector("#home"),"click",ac);listen(z,V,an);listen(z,A,J)};